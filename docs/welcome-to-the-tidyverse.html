<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Welcome to the Tidyverse | CDABS R Workshop Series</title>
  <meta name="description" content="This is material to accompany a 4 part introduction to R workshop series." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Welcome to the Tidyverse | CDABS R Workshop Series" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is material to accompany a 4 part introduction to R workshop series." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Welcome to the Tidyverse | CDABS R Workshop Series" />
  
  <meta name="twitter:description" content="This is material to accompany a 4 part introduction to R workshop series." />
  

<meta name="author" content="Jean-Paul Courneya and Amy Yarnell" />


<meta name="date" content="2022-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-r-and-rstudio.html"/>
<link rel="next" href="plotting-with-ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CDABS R Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.1</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.2</b> License</a></li>
</ul></li>
<li class="part"><span><b>Session I</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#why-learn-r"><i class="fa fa-check"></i><b>2.2</b> Why learn R?</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#starting-out-in-r"><i class="fa fa-check"></i><b>2.3</b> Starting out in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#downloading-installing-and-running-r"><i class="fa fa-check"></i><b>2.3.1</b> Downloading, Installing and Running R</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>2.3.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#rstudio-cloud"><i class="fa fa-check"></i><b>2.3.3</b> RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-this-book"><i class="fa fa-check"></i><b>2.4</b> Using this book</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#working-in-the-console"><i class="fa fa-check"></i><b>2.5</b> Working in the Console</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#objects"><i class="fa fa-check"></i><b>2.6</b> Objects</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#creating-objects"><i class="fa fa-check"></i><b>2.6.1</b> Creating Objects</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#saving-code-in-an-r-script"><i class="fa fa-check"></i><b>2.7</b> Saving code in an R script</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#setting-your-working-directory"><i class="fa fa-check"></i><b>2.7.1</b> Setting your Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>2.8</b> Functions and their arguments</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.8.1</b> Getting Help</a></li>
<li class="chapter" data-level="2.8.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#challenge-using-functions"><i class="fa fa-check"></i><b>2.8.2</b> Challenge: using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#packages"><i class="fa fa-check"></i><b>2.9</b> Packages</a></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#vectors"><i class="fa fa-check"></i><b>2.10</b> Vectors</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#missing-data"><i class="fa fa-check"></i><b>2.10.1</b> Missing Data</a></li>
<li class="chapter" data-level="2.10.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#mixing-types"><i class="fa fa-check"></i><b>2.10.2</b> Mixing types</a></li>
<li class="chapter" data-level="2.10.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#indexing-and-subsetting-vectors"><i class="fa fa-check"></i><b>2.10.3</b> Indexing and Subsetting vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-frames-tibbles-and-exploring-data"><i class="fa fa-check"></i><b>2.11</b> Data frames, Tibbles and Exploring Data</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#creating-data-frames"><i class="fa fa-check"></i><b>2.11.1</b> Creating data frames</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Session II</b></span></li>
<li class="chapter" data-level="3" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Welcome to the Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#install"><i class="fa fa-check"></i><b>3.1</b> Install</a></li>
<li class="chapter" data-level="3.2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#the-data"><i class="fa fa-check"></i><b>3.2</b> The Data</a></li>
<li class="chapter" data-level="3.3" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#importing-data"><i class="fa fa-check"></i><b>3.3</b> Importing data</a></li>
<li class="chapter" data-level="3.4" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#working-with-columns"><i class="fa fa-check"></i><b>3.4</b> Working with columns</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#select"><i class="fa fa-check"></i><b>3.4.1</b> <code>Select()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#renaming-columns"><i class="fa fa-check"></i><b>3.4.2</b> Renaming columns</a></li>
<li class="chapter" data-level="3.4.3" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#creating-new-columns-with-mutate"><i class="fa fa-check"></i><b>3.4.3</b> Creating new columns with <code>mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#working-with-rows"><i class="fa fa-check"></i><b>3.5</b> Working with rows</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#filter"><i class="fa fa-check"></i><b>3.5.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#grouping-and-summarizing-data"><i class="fa fa-check"></i><b>3.5.2</b> Grouping and Summarizing data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#joining-datasets"><i class="fa fa-check"></i><b>3.6</b> Joining Datasets</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#long-vs-wide-formats"><i class="fa fa-check"></i><b>3.6.1</b> Long vs Wide formats</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Session III</b></span></li>
<li class="chapter" data-level="4" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Plotting with ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#barplots"><i class="fa fa-check"></i><b>4.1</b> Barplots</a></li>
</ul></li>
<li class="part"><span><b>Session IV</b></span></li>
<li class="chapter" data-level="5" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html"><i class="fa fa-check"></i><b>5</b> Reproducible Project Management</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#rstudio-projects"><i class="fa fa-check"></i><b>5.1</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#what-is-real"><i class="fa fa-check"></i><b>5.1.1</b> What is Real?</a></li>
<li class="chapter" data-level="5.1.2" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#where-does-your-analysis-live"><i class="fa fa-check"></i><b>5.1.2</b> Where does your analysis live?</a></li>
<li class="chapter" data-level="5.1.3" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#createRproj"><i class="fa fa-check"></i><b>5.1.3</b> Creating an RStudio project</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#version-control-and-rstudio"><i class="fa fa-check"></i><b>5.2</b> Version Control and RStudio</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#why-git"><i class="fa fa-check"></i><b>5.2.1</b> Why Git?</a></li>
<li class="chapter" data-level="5.2.2" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#whats-github"><i class="fa fa-check"></i><b>5.2.2</b> What’s GitHub?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#settingupremote"><i class="fa fa-check"></i><b>5.3</b> Setting up a remote repository on Github</a></li>
<li class="chapter" data-level="5.4" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#connecting-rstudio-to-github"><i class="fa fa-check"></i><b>5.4</b> Connecting Rstudio to Github</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#introduce-yourself-to-git"><i class="fa fa-check"></i><b>5.4.1</b> Introduce yourself to Git</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#get-a-personal-access-token-pat"><i class="fa fa-check"></i><b>5.5</b> Get a personal access token (PAT)</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#create-the-pat"><i class="fa fa-check"></i><b>5.5.1</b> Create the PAT</a></li>
<li class="chapter" data-level="5.5.2" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#put-your-pat-into-the-git-credential-store"><i class="fa fa-check"></i><b>5.5.2</b> Put your PAT into the Git credential store</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#checking-out-a-project-from-a-version-control-remote-repository"><i class="fa fa-check"></i><b>5.6</b> Checking out a project from a version control remote repository</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#clone-the-new-github-repository-to-your-computer-via-rstudio"><i class="fa fa-check"></i><b>5.6.1</b> Clone the new GitHub repository to your computer via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#making-some-changes-save-commit."><i class="fa fa-check"></i><b>5.7</b> Making some changes, save, commit.</a></li>
<li class="chapter" data-level="5.8" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#push-your-local-changes-online-to-github"><i class="fa fa-check"></i><b>5.8</b> Push your local changes online to GitHub</a></li>
<li class="chapter" data-level="5.9" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#confirm-the-local-change-propagated-to-the-github-remote"><i class="fa fa-check"></i><b>5.9</b> Confirm the local change propagated to the GitHub remote</a></li>
<li class="chapter" data-level="5.10" data-path="reproducible-project-management.html"><a href="reproducible-project-management.html#clean-up"><i class="fa fa-check"></i><b>5.10</b> Clean up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html"><i class="fa fa-check"></i><b>6</b> Reproducible Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#what-is-r-markdown"><i class="fa fa-check"></i><b>6.1</b> What is R Markdown</a></li>
<li class="chapter" data-level="6.2" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#r-markdown-related-packages"><i class="fa fa-check"></i><b>6.2</b> R Markdown Related Packages</a></li>
<li class="chapter" data-level="6.3" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#how-does-r-markdown-work"><i class="fa fa-check"></i><b>6.3</b> How does R Markdown work</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#creating-an-r-markdown-file"><i class="fa fa-check"></i><b>6.3.1</b> Creating an R Markdown file</a></li>
<li class="chapter" data-level="6.3.2" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#r-markdown-basic-components"><i class="fa fa-check"></i><b>6.3.2</b> R Markdown Basic Components</a></li>
<li class="chapter" data-level="6.3.3" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#markdown"><i class="fa fa-check"></i><b>6.3.3</b> Markdown</a></li>
<li class="chapter" data-level="6.3.4" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#r-code-chunks"><i class="fa fa-check"></i><b>6.3.4</b> R code chunks</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="reproducible-reports-with-r-markdown.html"><a href="reproducible-reports-with-r-markdown.html#resources-for-r-markdown"><i class="fa fa-check"></i><b>6.4</b> Resources for R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="shiny-apps.html"><a href="shiny-apps.html"><i class="fa fa-check"></i><b>7</b> Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.1" data-path="shiny-apps.html"><a href="shiny-apps.html#shiny-tutorial-2"><i class="fa fa-check"></i><b>7.1</b> Shiny app basics</a></li>
<li class="chapter" data-level="7.2" data-path="shiny-apps.html"><a href="shiny-apps.html#create-an-empty-shiny-app"><i class="fa fa-check"></i><b>7.2</b> Create an empty Shiny app</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="shiny-apps.html"><a href="shiny-apps.html#alternate-way-to-create-a-shiny-app-separate-ui-and-server-files"><i class="fa fa-check"></i><b>7.2.1</b> Alternate way to create a Shiny app: separate UI and server files</a></li>
<li class="chapter" data-level="7.2.2" data-path="shiny-apps.html"><a href="shiny-apps.html#let-rstudio-fill-out-a-shiny-app-template-for-you"><i class="fa fa-check"></i><b>7.2.2</b> Let RStudio fill out a Shiny app template for you</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="shiny-apps.html"><a href="shiny-apps.html#an-example-shiny-app"><i class="fa fa-check"></i><b>7.3</b> An example Shiny App</a></li>
<li class="chapter" data-level="7.4" data-path="shiny-apps.html"><a href="shiny-apps.html#host-your-shiny-app"><i class="fa fa-check"></i><b>7.4</b> Host your Shiny App</a></li>
<li class="chapter" data-level="7.5" data-path="shiny-apps.html"><a href="shiny-apps.html#resources"><i class="fa fa-check"></i><b>7.5</b> Resources</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="further-resources.html"><a href="further-resources.html"><i class="fa fa-check"></i><b>A</b> Further Resources</a>
<ul>
<li class="chapter" data-level="A.1" data-path="further-resources.html"><a href="further-resources.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>A.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="A.2" data-path="further-resources.html"><a href="further-resources.html#the-tidyverse"><i class="fa fa-check"></i><b>A.2</b> The Tidyverse</a></li>
<li class="chapter" data-level="A.3" data-path="further-resources.html"><a href="further-resources.html#graphing-in-r"><i class="fa fa-check"></i><b>A.3</b> Graphing in R</a></li>
<li class="chapter" data-level="A.4" data-path="further-resources.html"><a href="further-resources.html#r-based-technologies"><i class="fa fa-check"></i><b>A.4</b> R Based Technologies</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="selected-glossary-of-r-terminology.html"><a href="selected-glossary-of-r-terminology.html"><i class="fa fa-check"></i><b>B</b> Selected Glossary of R Terminology</a></li>
<li class="chapter" data-level="C" data-path="packages-and-functions-used.html"><a href="packages-and-functions-used.html"><i class="fa fa-check"></i><b>C</b> Packages and Functions Used</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CDABS R Workshop Series</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="welcome-to-the-tidyverse" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Welcome to the Tidyverse<a href="welcome-to-the-tidyverse.html#welcome-to-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lesson we will be using a group of packages which are part of what is known as the <strong><code>tidyverse</code></strong>. These packages include :</p>
<ul>
<li><strong><code>readr</code></strong> for importing data into R</li>
<li><strong><code>dplyr</code></strong> for handling common data wrangling tasks for tabular data</li>
<li><strong><code>tidyr</code></strong> which enables you to swiftly convert between different data formats (long vs. wide) for plotting and analysis</li>
<li><strong><code>lubridate</code></strong> for working with dates</li>
<li><strong><code>ggplot2</code></strong> for visualizing data.</li>
</ul>
<p>For the full list of tidyverse packages and documentation visit <a href="https://www.tidyverse.org/">tidyverse.org</a>
You can install these packages individually, or you can install the entire tidyverse in one go.</p>
<div id="install" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Install<a href="welcome-to-the-tidyverse.html#install" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we are going to use <code>install.packages()</code> to install <strong><code>tidyverse</code></strong>. Then we are going to load <strong><code>tidyverse</code></strong> with the <code>library()</code> function. You only need to install a package once, but you will load it each time you start a new r session. To learn more about <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong> after the workshop, you may want to check out this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">handy data transformation with <strong><code>dplyr</code></strong> cheatsheet</a> and this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">one about <strong><code>tidyr</code></strong></a>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="welcome-to-the-tidyverse.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install tidyverse if you haven&#39;t yet</span></span>
<span id="cb92-2"><a href="welcome-to-the-tidyverse.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb92-3"><a href="welcome-to-the-tidyverse.html#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="welcome-to-the-tidyverse.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#load tidyverse</span></span>
<span id="cb92-5"><a href="welcome-to-the-tidyverse.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.7     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div id="the-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> The Data<a href="welcome-to-the-tidyverse.html#the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this lesson we will be using data which comes from <a href="https://www.tycho.pitt.edu/">Project Tycho</a> - an open data project from the University of Pittsburgh which provides standardized datasets on numerous diseases to aid global health research.</p>
<p>Throughout this lesson, we will be using a dataset from Project Tycho featuring historical counts of measles cases in the U.S.. We want to clean and present this data in a way that makes it easy to see how measles cases fluctuated over time.</p>
<p>Our end result will be this graph:</p>
<p><img src="images/yearlyMeasles.png" width="672" style="display: block; margin: auto;" /></p>
<p>A useful feature of Project Tycho data is their use of a common set of variables. Read more about their <a href="%22https://osf.io/paefw/%22">data format</a>.</p>
</div>
<div id="importing-data" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Importing data<a href="welcome-to-the-tidyverse.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s import the data we’ll be working with. You can import data with code, or you can use RStudio’s GUI. Let’s look at both.</p>
<p>In the environment pane, select the button that says <code>Import Dataset</code> and choose the option <code>From text (readr)</code>. This means we are going to be using the <strong><code>reader</code></strong> package, which is part of the <strong><code>tidyverse</code></strong> to read a file.</p>
<p><img src="images/import_data.png" width="456" style="display: block; margin: auto;" /></p>
<p>Select <code>Browse</code> in the dialog box that opens, and navigate to your <code>data</code> folder and choose the file called <code>measles_us.csv</code></p>
<p><img src="images/import_browse.png" width="813" style="display: block; margin: auto;" />
<img src="images/import_browse2.png" width="484" style="display: block; margin: auto;" /></p>
<p>A new window will open with a spreadsheet view of the data. We can use this window to make some choices about how the data is imported.</p>
<p><img src="images/import_window.png" width="812" style="display: block; margin: auto;" /></p>
<p>RStudio will use the file name as the default name for your dataset, but you could change it to whatever you want. In this case <code>measles_us</code> works pretty well.</p>
<p>RStudio will also try to guess the data type of your columns. It will mostly get it right, but it is not unusual that you will manually need to tell it what data type certain columns are.</p>
<p>For example, let’s look at the columns <code>PeriodStartDate</code> and <code>PeriodEndDate</code>. These columns contain dates, but RStudio wants to read them as character data. This is very common when importing data. Let’s change these columns to the date data type, by using the drop down menu to select date data.</p>
<p><img src="images/data_dropdown.PNG" width="145" style="display: block; margin: auto;" /></p>
<p>You will be asked to confirm that the input format of the date is <code>%m/%d/%Y</code> which is like writing <code>mm/dd/YYYY</code>. The program needs to know what the correct input date is so it can return the right output date <code>YYYY-mm-dd</code>, the international standard date format.</p>
<p><img src="images/data_dropdown_confirm.PNG" width="270" style="display: block; margin: auto;" /></p>
<p>Now our data is ready to import. Your import screen should look like:</p>
<p><img src="images/import_data_after.png" width="814" style="display: block; margin: auto;" /></p>
<p>We can select the import button. But as you may have noticed, the code behind this import dialog box is also being generated. Use the clipboard icon to copy the code.</p>
<p>Let’s paste that into our <code>script.R</code> file.</p>
<p>So what does all this code actually mean?</p>
<p>We are using a function from the <strong><code>readr</code></strong> package called <code>read_csv()</code>. This function takes as an argument the path to where the file is located. This can take the form of an absolute path, a relative path to the working directory, or a url. The <code>col_types</code> argument lets you specify the data type by column name, and the <code>na</code> argument lets you specify the value that should be read as <code>NA</code> in your data set.</p>
<div class="shaded important">
<p>Remember to make sure you set your working directory before trying to import data!</p>
</div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="welcome-to-the-tidyverse.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb96-2"><a href="welcome-to-the-tidyverse.html#cb96-2" aria-hidden="true" tabindex="-1"></a>measles_us <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb96-3"><a href="welcome-to-the-tidyverse.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;data/measles_us.csv&quot;</span>,</span>
<span id="cb96-4"><a href="welcome-to-the-tidyverse.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb96-5"><a href="welcome-to-the-tidyverse.html#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">PeriodStartDate =</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>),</span>
<span id="cb96-6"><a href="welcome-to-the-tidyverse.html#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PeriodEndDate =</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>)),</span>
<span id="cb96-7"><a href="welcome-to-the-tidyverse.html#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="st">&quot;NA&quot;</span></span>
<span id="cb96-8"><a href="welcome-to-the-tidyverse.html#cb96-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="welcome-to-the-tidyverse.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(measles_us)</span></code></pre></div>
<p>After reading the data, you will typically want to inspect it and make sure everything looks okay. There are several ways of doing this. In your script above, <code>View()</code> opens the data as a file in your documents pane.</p>
<p>The most basic way is to call the name of the object as we did in the last lesson with vectors. Since we used <code>read_csv()</code>, the object will print as a tibble. The problem with this, is that it will only show as many columns as can fit in your window. So it’s good to know a few other ways to look at your data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="welcome-to-the-tidyverse.html#cb98-1" aria-hidden="true" tabindex="-1"></a>measles_us</span></code></pre></div>
<pre><code>## # A tibble: 422,051 × 9
##    ConditionName CountryName  Admin1Name Admin1ISO PeriodStartDate PeriodEndDate
##    &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;     &lt;date&gt;          &lt;date&gt;       
##  1 Measles       UNITED STAT… WISCONSIN  US-WI     1927-11-20      1927-11-26   
##  2 Measles       UNITED STAT… WISCONSIN  US-WI     1927-11-27      1927-12-03   
##  3 Measles       UNITED STAT… WISCONSIN  US-WI     1927-12-04      1927-12-10   
##  4 Measles       UNITED STAT… WISCONSIN  US-WI     1927-12-18      1927-12-24   
##  5 Measles       UNITED STAT… WISCONSIN  US-WI     1927-12-25      1927-12-31   
##  6 Measles       UNITED STAT… WISCONSIN  US-WI     1928-01-01      1928-01-07   
##  7 Measles       UNITED STAT… WISCONSIN  US-WI     1928-01-08      1928-01-14   
##  8 Measles       UNITED STAT… WISCONSIN  US-WI     1928-01-15      1928-01-21   
##  9 Measles       UNITED STAT… WISCONSIN  US-WI     1928-01-22      1928-01-28   
## 10 Measles       UNITED STAT… WISCONSIN  US-WI     1928-01-29      1928-02-04   
## # … with 422,041 more rows, and 3 more variables:
## #   PartOfCumulativeCountSeries &lt;dbl&gt;, SourceName &lt;chr&gt;, CountValue &lt;dbl&gt;</code></pre>
<p>The <code>glimpse()</code> function lets you see the column names and data types clearly. This function is part of the <strong><code>tibble</code></strong> package which is loaded with the core <strong><code>tidyverse</code></strong>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="welcome-to-the-tidyverse.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary of columns and first few entries</span></span>
<span id="cb100-2"><a href="welcome-to-the-tidyverse.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(measles_us)</span></code></pre></div>
<pre><code>## Rows: 422,051
## Columns: 9
## $ ConditionName               &lt;chr&gt; &quot;Measles&quot;, &quot;Measles&quot;, &quot;Measles&quot;, &quot;Measles&quot;…
## $ CountryName                 &lt;chr&gt; &quot;UNITED STATES OF AMERICA&quot;, &quot;UNITED STATES…
## $ Admin1Name                  &lt;chr&gt; &quot;WISCONSIN&quot;, &quot;WISCONSIN&quot;, &quot;WISCONSIN&quot;, &quot;WI…
## $ Admin1ISO                   &lt;chr&gt; &quot;US-WI&quot;, &quot;US-WI&quot;, &quot;US-WI&quot;, &quot;US-WI&quot;, &quot;US-WI…
## $ PeriodStartDate             &lt;date&gt; 1927-11-20, 1927-11-27, 1927-12-04, 1927-…
## $ PeriodEndDate               &lt;date&gt; 1927-11-26, 1927-12-03, 1927-12-10, 1927-…
## $ PartOfCumulativeCountSeries &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ SourceName                  &lt;chr&gt; &quot;US Nationally Notifiable Disease Surveill…
## $ CountValue                  &lt;dbl&gt; 85, 120, 84, 106, 39, 45, 28, 140, 48, 85,…</code></pre>
<p>You can also use the <code>head()</code> function to view the first <code>n</code> rows. The function defaults to 6 rows, but you can specify the number you want with an argument. Below we ask to see just the first 5 rows.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="welcome-to-the-tidyverse.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first n rows (defaults to 6)</span></span>
<span id="cb102-2"><a href="welcome-to-the-tidyverse.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(measles_us, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 9
##   ConditionName CountryName   Admin1Name Admin1ISO PeriodStartDate PeriodEndDate
##   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;date&gt;          &lt;date&gt;       
## 1 Measles       UNITED STATE… WISCONSIN  US-WI     1927-11-20      1927-11-26   
## 2 Measles       UNITED STATE… WISCONSIN  US-WI     1927-11-27      1927-12-03   
## 3 Measles       UNITED STATE… WISCONSIN  US-WI     1927-12-04      1927-12-10   
## 4 Measles       UNITED STATE… WISCONSIN  US-WI     1927-12-18      1927-12-24   
## 5 Measles       UNITED STATE… WISCONSIN  US-WI     1927-12-25      1927-12-31   
## # … with 3 more variables: PartOfCumulativeCountSeries &lt;dbl&gt;, SourceName &lt;chr&gt;,
## #   CountValue &lt;dbl&gt;</code></pre>
</div>
<div id="working-with-columns" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Working with columns<a href="welcome-to-the-tidyverse.html#working-with-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="select" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> <code>Select()</code><a href="welcome-to-the-tidyverse.html#select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To select columns of a data frame, use <code>select()</code>. This is a great way to create a smaller data frame with only the variables you are interested in.</p>
<p><code>select()</code> is a function. Remember that functions have arguments which go inside the parentheses. The <em>first argument</em> to this function is the name of the data object, which in this case is <code>measles_us</code>, and the subsequent arguments are the names of the columns we want to keep, separated by commas.</p>
<p>Let’s try selecting the <code>Admin1Name</code> column and the <code>CountValue</code> column.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="welcome-to-the-tidyverse.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(measles_us, Admin1Name, CountValue)</span></code></pre></div>
<pre><code>## # A tibble: 422,051 × 2
##    Admin1Name CountValue
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 WISCONSIN          85
##  2 WISCONSIN         120
##  3 WISCONSIN          84
##  4 WISCONSIN         106
##  5 WISCONSIN          39
##  6 WISCONSIN          45
##  7 WISCONSIN          28
##  8 WISCONSIN         140
##  9 WISCONSIN          48
## 10 WISCONSIN          85
## # … with 422,041 more rows</code></pre>
<p>As you can imagine, if you had a number of columns to select, it could get tiresome to write them all out. One way around this is to use a colon <code>:</code> to name a range of adjacent columns.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="welcome-to-the-tidyverse.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(measles_us, ConditionName<span class="sc">:</span>Admin1ISO)</span></code></pre></div>
<pre><code>## # A tibble: 422,051 × 4
##    ConditionName CountryName              Admin1Name Admin1ISO
##    &lt;chr&gt;         &lt;chr&gt;                    &lt;chr&gt;      &lt;chr&gt;    
##  1 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  2 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  3 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  4 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  5 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  6 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  7 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  8 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
##  9 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
## 10 Measles       UNITED STATES OF AMERICA WISCONSIN  US-WI    
## # … with 422,041 more rows</code></pre>
<p>Another helpful tool that the <strong><code>tidyverse</code></strong> provides is the <strong><code>pipe</code></strong> operator which looks like <strong><code>%&gt;%</code></strong>. The pipe is made available via the <strong><code>magrittr</code></strong> package, installed automatically with <strong><code>dplyr</code></strong>. If you use RStudio, you can type the pipe with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a PC or <kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a Mac.</p>
<p>With the pipe you start with your data object and pipe it to the function, rather than naming the data as your first argument. So, the pipe becomes especially valuable when you have a number of steps that you want to connect. Another benefit of using the pipe in RStudio is that the interface will supply column names to you in the auto complete. This helps so you do not need to remember sometimes lengthy column names, and you are less likely to get an error from a typo.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="welcome-to-the-tidyverse.html#cb108-1" aria-hidden="true" tabindex="-1"></a>measles_us <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="welcome-to-the-tidyverse.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Admin1Name, PartOfCumulativeCountSeries)</span></code></pre></div>
<pre><code>## # A tibble: 422,051 × 2
##    Admin1Name PartOfCumulativeCountSeries
##    &lt;chr&gt;                            &lt;dbl&gt;
##  1 WISCONSIN                            0
##  2 WISCONSIN                            0
##  3 WISCONSIN                            0
##  4 WISCONSIN                            0
##  5 WISCONSIN                            0
##  6 WISCONSIN                            0
##  7 WISCONSIN                            0
##  8 WISCONSIN                            0
##  9 WISCONSIN                            0
## 10 WISCONSIN                            0
## # … with 422,041 more rows</code></pre>
<p>Now unfortunately, we did not save this to an object, so while it prints out to the console, we cannot really do anything with these results. So now, let’s think through which columns we want for our analysis and save this to a new object called <code>measles_us_mod</code>.</p>
<p>So if we look at our data, we see that the columns <code>ConditionName</code>, <code>CountryName</code>, and <code>SourceName</code> have the same values throughout the data set. So it seems redundant to keep those. <code>Admin1ISO</code> has redundant information to <code>Admin1Name</code>, so we can probably get rid of that as well. For this particular analysis we are going to take a state level view of measles, so we do not need <code>Admin2Name</code> and <code>CityName</code> either. That leaves us with <code>Admin1Name</code>, <code>PeriodStartDate</code>, <code>PeriodEndDate</code>, <code>PartOfCumulativeCountSeries</code>, and <code>CountValue</code>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="welcome-to-the-tidyverse.html#cb110-1" aria-hidden="true" tabindex="-1"></a>measles_us_mod <span class="ot">&lt;-</span></span>
<span id="cb110-2"><a href="welcome-to-the-tidyverse.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  measles_us <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="welcome-to-the-tidyverse.html#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb110-4"><a href="welcome-to-the-tidyverse.html#cb110-4" aria-hidden="true" tabindex="-1"></a>    Admin1Name,</span>
<span id="cb110-5"><a href="welcome-to-the-tidyverse.html#cb110-5" aria-hidden="true" tabindex="-1"></a>    PeriodStartDate,</span>
<span id="cb110-6"><a href="welcome-to-the-tidyverse.html#cb110-6" aria-hidden="true" tabindex="-1"></a>    PeriodEndDate,</span>
<span id="cb110-7"><a href="welcome-to-the-tidyverse.html#cb110-7" aria-hidden="true" tabindex="-1"></a>    PartOfCumulativeCountSeries,</span>
<span id="cb110-8"><a href="welcome-to-the-tidyverse.html#cb110-8" aria-hidden="true" tabindex="-1"></a>    CountValue</span>
<span id="cb110-9"><a href="welcome-to-the-tidyverse.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-10"><a href="welcome-to-the-tidyverse.html#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="welcome-to-the-tidyverse.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">#inspect our new data frame</span></span>
<span id="cb110-12"><a href="welcome-to-the-tidyverse.html#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(measles_us_mod)</span></code></pre></div>
<pre><code>## Rows: 422,051
## Columns: 5
## $ Admin1Name                  &lt;chr&gt; &quot;WISCONSIN&quot;, &quot;WISCONSIN&quot;, &quot;WISCONSIN&quot;, &quot;WI…
## $ PeriodStartDate             &lt;date&gt; 1927-11-20, 1927-11-27, 1927-12-04, 1927-…
## $ PeriodEndDate               &lt;date&gt; 1927-11-26, 1927-12-03, 1927-12-10, 1927-…
## $ PartOfCumulativeCountSeries &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ CountValue                  &lt;dbl&gt; 85, 120, 84, 106, 39, 45, 28, 140, 48, 85,…</code></pre>
<p>Now when you look in your environment pane, you should see your new object which as the same number of rows but 6 instead of 11 columns (or variables)</p>
</div>
<div id="renaming-columns" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Renaming columns<a href="welcome-to-the-tidyverse.html#renaming-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes when you receive data, you may find that the column names are not very descriptive or useful, and it may be necessary to rename them. You can assign new names to columns when you select them <code>select(newColumnName = OldColumnName)</code> or you can use the <code>rename()</code> function. Like naming objects, you should use a simple, descriptive, relatively short name without spaces for your column names.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="welcome-to-the-tidyverse.html#cb112-1" aria-hidden="true" tabindex="-1"></a>measles_us_mod <span class="ot">&lt;-</span></span>
<span id="cb112-2"><a href="welcome-to-the-tidyverse.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(measles_us_mod, <span class="at">State =</span> Admin1Name)</span></code></pre></div>
</div>
<div id="creating-new-columns-with-mutate" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Creating new columns with <code>mutate()</code><a href="welcome-to-the-tidyverse.html#creating-new-columns-with-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Frequently you’ll want to create new columns based on the values in existing columns, for example to do unit conversions, or to find the ratio of values in two columns. For this you can use the <code>mutate()</code> function. The <code>transmute()</code> function is similar, but <strong>replaces</strong> old columns with the new one.</p>
<p>We know that each row in our dataset represents some time span, but we’re not sure what that span is. Below we use <code>mutate()</code> to create a new column called Span, which gives the number of days between the PeriodEndDate column and the PeriodStartDate column. This is why it is important to make sure your date columns are parsed properly as dates when importing your data. If the dates had been left as character data, it would not have been possible to do arithmetic with them.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="welcome-to-the-tidyverse.html#cb113-1" aria-hidden="true" tabindex="-1"></a>measles_us_mod <span class="ot">&lt;-</span> </span>
<span id="cb113-2"><a href="welcome-to-the-tidyverse.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(measles_us_mod, <span class="at">Span =</span> PeriodEndDate <span class="sc">-</span> PeriodStartDate)</span>
<span id="cb113-3"><a href="welcome-to-the-tidyverse.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="welcome-to-the-tidyverse.html#cb113-4" aria-hidden="true" tabindex="-1"></a>measles_us_mod</span></code></pre></div>
<pre><code>## # A tibble: 422,051 × 6
##    State     PeriodStartDate PeriodEndDate PartOfCumulativeCou… CountValue Span 
##    &lt;chr&gt;     &lt;date&gt;          &lt;date&gt;                       &lt;dbl&gt;      &lt;dbl&gt; &lt;drt&gt;
##  1 WISCONSIN 1927-11-20      1927-11-26                       0         85 6 da…
##  2 WISCONSIN 1927-11-27      1927-12-03                       0        120 6 da…
##  3 WISCONSIN 1927-12-04      1927-12-10                       0         84 6 da…
##  4 WISCONSIN 1927-12-18      1927-12-24                       0        106 6 da…
##  5 WISCONSIN 1927-12-25      1927-12-31                       0         39 6 da…
##  6 WISCONSIN 1928-01-01      1928-01-07                       0         45 6 da…
##  7 WISCONSIN 1928-01-08      1928-01-14                       0         28 6 da…
##  8 WISCONSIN 1928-01-15      1928-01-21                       0        140 6 da…
##  9 WISCONSIN 1928-01-22      1928-01-28                       0         48 6 da…
## 10 WISCONSIN 1928-01-29      1928-02-04                       0         85 6 da…
## # … with 422,041 more rows</code></pre>
<p>It’s hard to get a sense of what different time spans are present in our data. We can use the <code>count()</code> function to help us figure that out.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="welcome-to-the-tidyverse.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(measles_us_mod,Span)</span></code></pre></div>
<pre><code>## # A tibble: 59 × 2
##    Span         n
##    &lt;drtn&gt;   &lt;int&gt;
##  1  6 days 338063
##  2 13 days    558
##  3 20 days    693
##  4 27 days    782
##  5 34 days    857
##  6 41 days    929
##  7 48 days    913
##  8 55 days    997
##  9 62 days   1083
## 10 69 days   1136
## # … with 49 more rows</code></pre>
<p>All those different time spans will get us into trouble when we try to work with the data. So next we need to filter the dataset for only the rows we want.</p>
</div>
</div>
<div id="working-with-rows" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Working with rows<a href="welcome-to-the-tidyverse.html#working-with-rows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filter" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> <code>filter()</code><a href="welcome-to-the-tidyverse.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> lets us choose columns. To choose rows based on a specific criteria, we can use the <code>filter()</code> function. The arguments after the data frame are the condition(s) we want for our final dataframe to adhere to. Specify conditions using logical operator:</p>
<table>
<thead>
<tr class="header">
<th align="left">operator</th>
<th align="left">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">==</td>
<td align="left">exactly equal</td>
</tr>
<tr class="even">
<td align="left">!=</td>
<td align="left">not equal to</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">less than</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">less than or equal to</td>
</tr>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">greater than</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">greater than or equal to</td>
</tr>
<tr class="odd">
<td align="left">x|y</td>
<td align="left">x or y</td>
</tr>
<tr class="even">
<td align="left">x&amp;y</td>
<td align="left">x and y</td>
</tr>
<tr class="odd">
<td align="left">!x</td>
<td align="left">not x</td>
</tr>
</tbody>
</table>
<p>We’ll come back to our problem of different time spans in a moment. First, let’s try filtering our data by just one condition. We want to see just the rows that contain counts from Maryland.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="welcome-to-the-tidyverse.html#cb117-1" aria-hidden="true" tabindex="-1"></a>measles_us_mod <span class="sc">%&gt;%</span> <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&quot;MARYLAND&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7,246 × 6
##    State    PeriodStartDate PeriodEndDate PartOfCumulativeCoun… CountValue Span 
##    &lt;chr&gt;    &lt;date&gt;          &lt;date&gt;                        &lt;dbl&gt;      &lt;dbl&gt; &lt;drt&gt;
##  1 MARYLAND 1927-11-27      1927-12-03                        0         64 6 da…
##  2 MARYLAND 1927-12-04      1927-12-10                        0         88 6 da…
##  3 MARYLAND 1927-12-18      1927-12-24                        0        105 6 da…
##  4 MARYLAND 1927-12-25      1927-12-31                        0        109 6 da…
##  5 MARYLAND 1928-01-01      1928-01-07                        0        175 6 da…
##  6 MARYLAND 1928-01-08      1928-01-14                        0        249 6 da…
##  7 MARYLAND 1928-01-15      1928-01-21                        0        345 6 da…
##  8 MARYLAND 1928-01-22      1928-01-28                        0        365 6 da…
##  9 MARYLAND 1928-01-29      1928-02-04                        0        504 6 da…
## 10 MARYLAND 1928-02-05      1928-02-11                        0        563 6 da…
## # … with 7,236 more rows</code></pre>
<div class="shaded important">
<p>When matching strings you must be exact. R is case-sensitive. So <code>State == "Maryland"</code> or <code>State == "maryland"</code> would return 0 rows.</p>
</div>
<p>You can add additional conditions to filter by, separated by commas or other logical operators like <code>&amp;</code>, <code>&gt;</code>, and <code>&gt;</code>.</p>
<p>Below we want just the rows for Maryland, and only include periods where the count was more than 500 reported cases. Note that while you need quotation marks around character data, you do not need them around numeric data.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="welcome-to-the-tidyverse.html#cb119-1" aria-hidden="true" tabindex="-1"></a>measles_us_mod <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="welcome-to-the-tidyverse.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&quot;MARYLAND&quot;</span> <span class="sc">&amp;</span> CountValue <span class="sc">&gt;</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## # A tibble: 328 × 6
##    State    PeriodStartDate PeriodEndDate PartOfCumulativeCoun… CountValue Span 
##    &lt;chr&gt;    &lt;date&gt;          &lt;date&gt;                        &lt;dbl&gt;      &lt;dbl&gt; &lt;drt&gt;
##  1 MARYLAND 1928-01-29      1928-02-04                        0        504 6 da…
##  2 MARYLAND 1928-02-05      1928-02-11                        0        563 6 da…
##  3 MARYLAND 1928-02-12      1928-02-18                        0        696 6 da…
##  4 MARYLAND 1928-02-19      1928-02-25                        0        750 6 da…
##  5 MARYLAND 1928-02-26      1928-03-03                        0       1012 6 da…
##  6 MARYLAND 1928-03-04      1928-03-10                        0        951 6 da…
##  7 MARYLAND 1928-03-11      1928-03-17                        0       1189 6 da…
##  8 MARYLAND 1928-03-18      1928-03-24                        0       1163 6 da…
##  9 MARYLAND 1928-03-25      1928-03-31                        0       1020 6 da…
## 10 MARYLAND 1928-04-01      1928-04-07                        0        753 6 da…
## # … with 318 more rows</code></pre>
</div>
<div id="grouping-and-summarizing-data" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Grouping and Summarizing data<a href="welcome-to-the-tidyverse.html#grouping-and-summarizing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many data analysis tasks can be approached using the <em>split-apply-combine</em> paradigm: split the data into groups, apply some analysis to each group, and then combine the results. <strong><code>dplyr</code></strong> makes this very easy through the use of the <code>group_by()</code> function.</p>
<p><code>group_by()</code> is often used together with <code>summarize()</code>, which collapses each group into a single-row summary of that group. <code>group_by()</code> takes as arguments the column names that contain the <strong>categorical</strong> variables for which you want to calculate the summary statistics.</p>
<p>Let’s return to our <code>measles_us_mod</code> data frame. To analyze this further, we need to separate out the rows that represent cumulative counts from the rows that have a fixed interval. So we use <code>filter()</code> as we did above, this time saving to a new object called <code>non_cumulative_period</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="welcome-to-the-tidyverse.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out cumulative counts</span></span>
<span id="cb121-2"><a href="welcome-to-the-tidyverse.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="welcome-to-the-tidyverse.html#cb121-3" aria-hidden="true" tabindex="-1"></a>non_cumulative <span class="ot">&lt;-</span></span>
<span id="cb121-4"><a href="welcome-to-the-tidyverse.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  measles_us_mod <span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="welcome-to-the-tidyverse.html#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PartOfCumulativeCountSeries <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<p>How can we calculate the total number of measles cases in each state for each reported time period?</p>
<p>First we need to group our data by state, and then group by period. Remember that in our original data set each state contained counts for multiple municipalities. That means in our current data frame there will be multiple rows for each period that needs to be condensed.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="welcome-to-the-tidyverse.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#group - prepares for summary calculations</span></span>
<span id="cb122-2"><a href="welcome-to-the-tidyverse.html#cb122-2" aria-hidden="true" tabindex="-1"></a>count_by_period <span class="ot">&lt;-</span></span>
<span id="cb122-3"><a href="welcome-to-the-tidyverse.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  non_cumulative <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="welcome-to-the-tidyverse.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State, PeriodStartDate)</span>
<span id="cb122-5"><a href="welcome-to-the-tidyverse.html#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="welcome-to-the-tidyverse.html#cb122-6" aria-hidden="true" tabindex="-1"></a>count_by_period</span></code></pre></div>
<pre><code>## # A tibble: 337,637 × 6
## # Groups:   State, PeriodStartDate [150,481]
##    State     PeriodStartDate PeriodEndDate PartOfCumulativeCou… CountValue Span 
##    &lt;chr&gt;     &lt;date&gt;          &lt;date&gt;                       &lt;dbl&gt;      &lt;dbl&gt; &lt;drt&gt;
##  1 WISCONSIN 1927-11-20      1927-11-26                       0         85 6 da…
##  2 WISCONSIN 1927-11-27      1927-12-03                       0        120 6 da…
##  3 WISCONSIN 1927-12-04      1927-12-10                       0         84 6 da…
##  4 WISCONSIN 1927-12-18      1927-12-24                       0        106 6 da…
##  5 WISCONSIN 1927-12-25      1927-12-31                       0         39 6 da…
##  6 WISCONSIN 1928-01-01      1928-01-07                       0         45 6 da…
##  7 WISCONSIN 1928-01-08      1928-01-14                       0         28 6 da…
##  8 WISCONSIN 1928-01-15      1928-01-21                       0        140 6 da…
##  9 WISCONSIN 1928-01-22      1928-01-28                       0         48 6 da…
## 10 WISCONSIN 1928-01-29      1928-02-04                       0         85 6 da…
## # … with 337,627 more rows</code></pre>
<p>When you inspect your new data frame, everything should look the same. Grouping prepares your data for summarize, but it does not do anything visually to the data.</p>
<p>Now let’s trying summarizing that data. <code>summarize()</code> takes the dataframe as it’s first argument, then you need to provide some calculation and the name for the new column where the results of that calculation will go. In this case, we will use the <code>sum()</code> function on the CountValue column and put this in a new column called TotalCount</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="welcome-to-the-tidyverse.html#cb124-1" aria-hidden="true" tabindex="-1"></a>count_by_period <span class="ot">&lt;-</span></span>
<span id="cb124-2"><a href="welcome-to-the-tidyverse.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  non_cumulative <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="welcome-to-the-tidyverse.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State, PeriodStartDate) <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href="welcome-to-the-tidyverse.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(CountValue))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;State&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>Notice how the use of pipes really comes in handy here. It saved us from having to create and keep track of a number of intermediate objects.</p>
<p>Now each row in our dataset represents a week of data. It might be better if we can look at yearly trends. So, let’s try separating out the year from PeriodStartDate into its own column. In addition to <code>mutate()</code>, we will also use the <code>year()</code> function from <strong><code>lubridate</code></strong>. Since <strong><code>lubridate</code></strong> is not loaded with the core <strong><code>tidyverse</code></strong> let’s go ahead and load that now.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="welcome-to-the-tidyverse.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<p>Remember, you only need to install a package once, but you have to load it with each new session.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="welcome-to-the-tidyverse.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get year in separate column from PeriodStartDate</span></span>
<span id="cb129-2"><a href="welcome-to-the-tidyverse.html#cb129-2" aria-hidden="true" tabindex="-1"></a>count_by_period <span class="ot">&lt;-</span> </span>
<span id="cb129-3"><a href="welcome-to-the-tidyverse.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  count_by_period <span class="sc">%&gt;%</span> </span>
<span id="cb129-4"><a href="welcome-to-the-tidyverse.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(PeriodStartDate))</span>
<span id="cb129-5"><a href="welcome-to-the-tidyverse.html#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="welcome-to-the-tidyverse.html#cb129-6" aria-hidden="true" tabindex="-1"></a>count_by_period</span></code></pre></div>
<pre><code>## # A tibble: 150,481 × 4
## # Groups:   State [56]
##    State   PeriodStartDate TotalCount  Year
##    &lt;chr&gt;   &lt;date&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 ALABAMA 1909-05-23               1  1909
##  2 ALABAMA 1910-01-16               1  1910
##  3 ALABAMA 1910-02-06              13  1910
##  4 ALABAMA 1910-04-10             127  1910
##  5 ALABAMA 1910-04-17              81  1910
##  6 ALABAMA 1910-04-24              73  1910
##  7 ALABAMA 1910-05-01              62  1910
##  8 ALABAMA 1910-05-09              72  1910
##  9 ALABAMA 1910-05-15              39  1910
## 10 ALABAMA 1910-05-22              38  1910
## # … with 150,471 more rows</code></pre>
<p>Now we can do our grouping and summarizing again as we did above.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="welcome-to-the-tidyverse.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get totals for each state each year.</span></span>
<span id="cb131-2"><a href="welcome-to-the-tidyverse.html#cb131-2" aria-hidden="true" tabindex="-1"></a>yearly_count_state <span class="ot">&lt;-</span></span>
<span id="cb131-3"><a href="welcome-to-the-tidyverse.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  count_by_period <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="welcome-to-the-tidyverse.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, State) <span class="sc">%&gt;%</span> </span>
<span id="cb131-5"><a href="welcome-to-the-tidyverse.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(TotalCount))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Year&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="welcome-to-the-tidyverse.html#cb133-1" aria-hidden="true" tabindex="-1"></a>yearly_count_state</span></code></pre></div>
<pre><code>## # A tibble: 4,210 × 3
## # Groups:   Year [96]
##     Year State         TotalCount
##    &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;
##  1  1906 CALIFORNIA           224
##  2  1906 CONNECTICUT           23
##  3  1906 FLORIDA                4
##  4  1906 ILLINOIS             187
##  5  1906 INDIANA               20
##  6  1906 KENTUCKY               2
##  7  1906 MAINE                 26
##  8  1906 MASSACHUSETTS        282
##  9  1906 MICHIGAN             320
## 10  1906 MISSOURI             274
## # … with 4,200 more rows</code></pre>
<p>Alternatively, to see a national level summary, we could group just by Year</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="welcome-to-the-tidyverse.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get totals each year.</span></span>
<span id="cb135-2"><a href="welcome-to-the-tidyverse.html#cb135-2" aria-hidden="true" tabindex="-1"></a>yearly_count <span class="ot">&lt;-</span></span>
<span id="cb135-3"><a href="welcome-to-the-tidyverse.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  count_by_period <span class="sc">%&gt;%</span> </span>
<span id="cb135-4"><a href="welcome-to-the-tidyverse.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="welcome-to-the-tidyverse.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(TotalCount))</span>
<span id="cb135-6"><a href="welcome-to-the-tidyverse.html#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="welcome-to-the-tidyverse.html#cb135-7" aria-hidden="true" tabindex="-1"></a>yearly_count</span></code></pre></div>
<pre><code>## # A tibble: 96 × 2
##     Year TotalCount
##    &lt;dbl&gt;      &lt;dbl&gt;
##  1  1906       2345
##  2  1907      40699
##  3  1908      55632
##  4  1909      56317
##  5  1910      87191
##  6  1911      62306
##  7  1912      66388
##  8  1913     117571
##  9  1914      57363
## 10  1915      95507
## # … with 86 more rows</code></pre>
</div>
</div>
<div id="joining-datasets" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Joining Datasets<a href="welcome-to-the-tidyverse.html#joining-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Of course, looking at total counts in each state is not the most helpful metric without taking population into account. To rectify this, let’s try joining some historical population data with our measles data.</p>
<p>First we need to import the population data.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="welcome-to-the-tidyverse.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load csv of populations by state over time, changing some of the datatypes from default</span></span>
<span id="cb137-2"><a href="welcome-to-the-tidyverse.html#cb137-2" aria-hidden="true" tabindex="-1"></a>hist_pop_by_state <span class="ot">&lt;-</span></span>
<span id="cb137-3"><a href="welcome-to-the-tidyverse.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(</span>
<span id="cb137-4"><a href="welcome-to-the-tidyverse.html#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data/Historical_Population_by_State.csv&quot;</span>,</span>
<span id="cb137-5"><a href="welcome-to-the-tidyverse.html#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">ALASKA =</span> <span class="fu">col_double</span>(), <span class="at">HAWAII =</span> <span class="fu">col_double</span>())</span>
<span id="cb137-6"><a href="welcome-to-the-tidyverse.html#cb137-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="welcome-to-the-tidyverse.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(hist_pop_by_state)</span></code></pre></div>
<p>As we saw in our measles data import, the presence of NAs makes it necessary to explicitly state that the Hawaii and Alaska columns contain numerical data.</p>
<div id="long-vs-wide-formats" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Long vs Wide formats<a href="welcome-to-the-tidyverse.html#long-vs-wide-formats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For data to be considered “tidy”, it should be in what is called “long” format. Each column is a variable, each row is an observation, and each cell is a value. Our state population data is in “wide” format, which is often preferable for human-readability, but is less ideal for machine-readability.</p>
<p>We will use the package <strong><code>tidyr</code></strong> and the function <code>pivot_longer</code> to convert our population data to a long format, thus making it easier to join with our measles data.</p>
<p>Each column in our population dataset represents a state. To make it tidy we are going to reduce those to one column called State with the state names as the values of the column. We will then need to create a new column for population containing the current cell values. To remember that the population data is provided in 1000s of persons, we will call this new column pop1000.</p>
<p><code>pivot_longer()</code> takes four principal arguments:</p>
<ol style="list-style-type: decimal">
<li>the data</li>
<li><em>cols</em> are the names of the columns we use to fill the new values variable (or to drop).</li>
<li>the <em>names_to</em> column variable we wish to create from the <em>cols</em> provided.</li>
<li>the <em>values_to</em> column variable we wish to create and fill with values associated with the <em>cols</em> provided.</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="welcome-to-the-tidyverse.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb139-2"><a href="welcome-to-the-tidyverse.html#cb139-2" aria-hidden="true" tabindex="-1"></a>hist_pop_long <span class="ot">&lt;-</span> hist_pop_by_state <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="welcome-to-the-tidyverse.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ALASKA<span class="sc">:</span>WYOMING,</span>
<span id="cb139-4"><a href="welcome-to-the-tidyverse.html#cb139-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;State&quot;</span>,</span>
<span id="cb139-5"><a href="welcome-to-the-tidyverse.html#cb139-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;pop1000&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="welcome-to-the-tidyverse.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(hist_pop_long)</span></code></pre></div>
<p>Now our two datasets have similar structures, a column of state names, a column of years, and a column of values. Let’s join these two datasets by the state and year columns. Note that if both sets have the same column names, you do not need to specify anything in the by argument. We use a left join here which preserves all the rows in our measles dataset and adds the matching rows from the population dataset.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="welcome-to-the-tidyverse.html#cb141-1" aria-hidden="true" tabindex="-1"></a>joined_df <span class="ot">&lt;-</span></span>
<span id="cb141-2"><a href="welcome-to-the-tidyverse.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(yearly_count_state, hist_pop_long, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;State&quot;</span> <span class="ot">=</span> <span class="st">&quot;State&quot;</span>, <span class="st">&quot;Year&quot;</span> <span class="ot">=</span> <span class="st">&quot;DATE&quot;</span> ))</span>
<span id="cb141-3"><a href="welcome-to-the-tidyverse.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="welcome-to-the-tidyverse.html#cb141-4" aria-hidden="true" tabindex="-1"></a>joined_df</span></code></pre></div>
<pre><code>## # A tibble: 4,210 × 4
## # Groups:   Year [96]
##     Year State         TotalCount pop1000
##    &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;
##  1  1906 CALIFORNIA           224    1976
##  2  1906 CONNECTICUT           23    1033
##  3  1906 FLORIDA                4     628
##  4  1906 ILLINOIS             187    5309
##  5  1906 INDIANA               20    2663
##  6  1906 KENTUCKY               2    2234
##  7  1906 MAINE                 26     729
##  8  1906 MASSACHUSETTS        282    3107
##  9  1906 MICHIGAN             320    2626
## 10  1906 MISSOURI             274    3223
## # … with 4,200 more rows</code></pre>
<p>Now we can use our old friend <code>mutate()</code> to add a rate column calculated from the count and pop1000 columns.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="welcome-to-the-tidyverse.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add column for rate (per 1000) of measles</span></span>
<span id="cb143-2"><a href="welcome-to-the-tidyverse.html#cb143-2" aria-hidden="true" tabindex="-1"></a>rate_by_year <span class="ot">&lt;-</span> <span class="fu">mutate</span>(joined_df, <span class="at">rate =</span> TotalCount <span class="sc">/</span> pop1000)</span>
<span id="cb143-3"><a href="welcome-to-the-tidyverse.html#cb143-3" aria-hidden="true" tabindex="-1"></a>rate_by_year</span></code></pre></div>
<pre><code>## # A tibble: 4,210 × 5
## # Groups:   Year [96]
##     Year State         TotalCount pop1000     rate
##    &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1906 CALIFORNIA           224    1976 0.113   
##  2  1906 CONNECTICUT           23    1033 0.0223  
##  3  1906 FLORIDA                4     628 0.00637 
##  4  1906 ILLINOIS             187    5309 0.0352  
##  5  1906 INDIANA               20    2663 0.00751 
##  6  1906 KENTUCKY               2    2234 0.000895
##  7  1906 MAINE                 26     729 0.0357  
##  8  1906 MASSACHUSETTS        282    3107 0.0908  
##  9  1906 MICHIGAN             320    2626 0.122   
## 10  1906 MISSOURI             274    3223 0.0850  
## # … with 4,200 more rows</code></pre>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-r-and-rstudio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CDABS-R-Series.pdf", "CDABS-R-Series.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
